webpackJsonp([2],{"7UBM":function(t,e){},"9Bl9":function(t,e,i){"use strict";e.a={sideBar:{search:"/app_bi/layout/getFolder",add_File:"/app_bi/layout/addFolder",edit_File:"/app_bi/layout/upFolder",del_File:"/app_bi/layout/delFolder",search_layout:"/app_bi/layout/getDesign",add_layout:"/app_bi/layout/addDesign",edit_layout:"/app_bi/layout/upDesign",del_layout:"/app_bi/layout/delDesign"}}},AGoC:function(t,e){},FYNu:function(t,e){},MZh4:function(t,e){},"Q/Y4":function(t,e){},TO4g:function(t,e){},WNAK:function(t,e,i){"use strict";var a=i("3cXf"),o=i.n(a),s=i("4YfN"),n=i.n(s),r={data:function(){var t=this;return{dialogConfig:{title:"修改布局名称",dialogVisible:!1,width:"400px",btnData:["cancel","save"]},baseData:[],rules:{name:[{validator:function(e,i,a){""===i?a(new Error("请输入文件名称")):-1!==t.baseData.findIndex(function(t){return t.alias===i})?a(new Error("文件夹下已存在该名称")):a()},trigger:"blur"}]},ruleForm:{name:""},url:""}},props:["title"],mounted:function(){},methods:{show:function(t,e){this.dialogConfig.title="新增"+this.title,this.ruleForm.name="",this.url=e,this.baseData=t,this.dialogConfig.dialogVisible=!0},close:function(){this.dialogConfig.dialogVisible=!1},save:function(){var t=this;this.$refs.ruleForm.validate(function(e){if(!e)return!1;var i={alias:t.ruleForm.name};t.$apis.fetchPost(t.url,{params:i,Vue:t}).then(function(e){e.result?(t.$parent.filterData(),t.close(),t.$message({type:"success",message:e.message})):t.$message({type:"warning",message:e.message})})})}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogConfig.dialogVisible?i("board-toast",{attrs:{config:t.dialogConfig},on:{cancel:t.close,save:t.save}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"文件名称",prop:"name"}},[i("el-col",{attrs:{span:20}},[i("el-input",{attrs:{size:"mini"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name","string"==typeof e?e.trim():e)},expression:"ruleForm.name"}})],1)],1)],1)],1):t._e()},staticRenderFns:[]},c=i("C7Lr")(r,l,!1,null,null,null).exports,d={data:function(){return{dialogConfig:{title:"修改布局名称",dialogVisible:!1,width:"400px",btnData:["cancel","save"],labelName:""},baseData:[],rules:{name:[{validator:function(t,e,i){""===e?i(new Error("请输入名称")):i()},trigger:"blur"}]},ruleForm:{name:"",id:""},url:"",parentId:-1,config:null}},props:["title"],mounted:function(){},methods:{show:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments[4];this.url=e,this.baseData=t,this.ruleForm.name=i.alias,this.parentId=o,this.config=i.config,this.ruleForm.id=i.id,"布局库"==this.title?(this.dialogConfig.title="编辑"==a?"布局重命名":"文件夹重命名",this.dialogConfig.labelName="编辑"==a?"布局名称":"文件夹名称"):(this.dialogConfig.title="编辑"==a?"看板重命名":"文件夹重命名",this.dialogConfig.labelName="编辑"==a?"看板名称":"文件夹名称"),this.dialogConfig.dialogVisible=!0},close:function(){this.dialogConfig.dialogVisible=!1},save:function(){var t=this;this.$refs.ruleForm.validate(function(e){if(!e)return!1;var i={alias:t.ruleForm.name,id:t.ruleForm.id};-1!=t.parentId&&(i.folderId=t.parentId,i.config=t.config),t.$apis.fetchPost(t.url,{params:i,Vue:t}).then(function(e){e.result?(t.$parent.filterData(),t.close(),t.$message({type:"success",message:e.message})):t.$message({type:"warning",message:e.message})})})}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogConfig.dialogVisible?i("board-toast",{attrs:{config:t.dialogConfig},on:{cancel:t.close,save:t.save}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:t.dialogConfig.labelName,prop:"name"}},[i("el-col",{attrs:{span:20}},[i("el-input",{attrs:{size:"mini"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name","string"==typeof e?e.trim():e)},expression:"ruleForm.name"}})],1)],1)],1)],1):t._e()},staticRenderFns:[]},f=i("C7Lr")(d,u,!1,null,null,null).exports,g={data:function(){return{dialogConfig:{title:"新增布局",dialogVisible:!1,width:"400px",btnData:["cancel","save"]},baseData:[],rules:{name:[{validator:function(t,e,i){""===e?i(new Error("请输入布局名称")):i()},trigger:"blur"}]},ruleForm:{name:""},url:"",parentId:-1}},mounted:function(){},methods:{show:function(t,e,i){this.ruleForm.name="",this.url=e,this.baseData=t,this.dialogConfig.dialogVisible=!0,this.parentId=i},close:function(){this.dialogConfig.dialogVisible=!1},save:function(){var t=this;this.$refs.ruleForm.validate(function(e){if(!e)return!1;var i={alias:t.ruleForm.name,folderId:t.parentId};t.$apis.fetchPost(t.url,{params:i,Vue:t}).then(function(e){e.result?(t.$parent.filterData(),t.close(),t.$message({type:"success",message:e.message})):t.$message({type:"warning",message:e.message})})})}}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogConfig.dialogVisible?i("board-toast",{attrs:{config:t.dialogConfig},on:{cancel:t.close,save:t.save}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"布局名称",prop:"name"}},[i("el-col",{attrs:{span:20}},[i("el-input",{attrs:{size:"mini"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name","string"==typeof e?e.trim():e)},expression:"ruleForm.name"}})],1)],1)],1)],1):t._e()},staticRenderFns:[]},h=i("C7Lr")(g,m,!1,null,null,null).exports,p=i("9Bl9"),b=i("TrN9"),v=i("xXv6"),C={data:function(){return{form:{name:"",value:""},rules:{name:[{required:!0,message:"请输入看板名称",trigger:"blur"}],value:[{required:!0,message:"请选择布局方案",trigger:"change"}]},configData:{layout:[],rowHeight:50,isDraggable:!1,isResizable:!1,line:1},customConfig:{title:"看板设置",dialogVisible:!1,width:"400px",btnData:["cancel","save"],list:[]},modellist:[]}},props:["baseData"],methods:{show:function(t){this.form={name:"",value:""},this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.modellist=t,this.customConfig.dialogVisible=!0},cancel:function(){this.customConfig.dialogVisible=!1,this.$emit("close")},save:function(){var t=this;this.$refs.ruleForm.validate(function(e){if(!e)return!1;t.$apis.fetchPost(b.a.sideBar.add_layout,{params:{layoutId:t.form.value,alias:t.form.name,reportType:"自定义",folderId:t.baseData.id},Vue:t}).then(function(e){e.result&&(t.customConfig.dialogVisible=!1,t.$emit("addSuccess"),t.$message({type:"success",message:e.message}))})})},handleChange:function(t){var e=this;t&&this.$apis.fetchPost(p.a.sideBar.search_layout,{params:{id:t},Vue:this}).then(function(t){t.result&&(t.model.config?e.configData.layout=JSON.parse(t.model.config).layout:e.configData.layout=[])})}},components:{superLayout:v.a}},y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"custom-border"},[i("board-toast",{attrs:{config:t.customConfig},on:{cancel:t.cancel,save:t.save,handleClose:function(e){t.customConfig.dialogVisible=!1}}},[i("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[i("el-form",{ref:"ruleForm",attrs:{model:t.form,"label-width":"100px",rules:t.rules}},[i("el-form-item",{attrs:{label:"看板名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入看板名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"布局方案",prop:"value"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"medium"},on:{change:t.handleChange},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}},t._l(t.modellist,function(e){return i("el-option-group",{key:e.id,attrs:{label:e.alias}},t._l(e.layouts,function(t){return i("el-option",{key:t.id,attrs:{label:t.alias,value:t.id}})}))}))],1)],1)],1),t._v(" "),i("div",{staticClass:"show-box no-scroll"},[i("super-layout",{ref:"superLayout",attrs:{config:t.configData,isToolbar:!1,tool:[]}})],1)])],1)},staticRenderFns:[]};var _=i("C7Lr")(C,y,!1,function(t){i("Q/Y4")},null,null).exports,D={data:function(){return{form:{name:"",value:""},rules:{name:[{required:!0,message:"请选输入看板名称",trigger:"blur"}],value:[{required:!0,message:"请选择模板方案",trigger:"change"}]},customConfig:{title:"看板设置",dialogVisible:!1,width:"400px",btnData:["cancel","save"],list:[]},modellist:[],currentTemUrl:""}},props:["baseData"],methods:{show:function(t){this.form={name:"",value:""},this.modellist=t,this.customConfig.dialogVisible=!0},cancel:function(){this.customConfig.dialogVisible=!1,this.$emit("close")},save:function(){var t=this;this.$refs.ruleForm.validate(function(e){if(!e)return!1;t.$apis.fetchPost(b.a.sideBar.add_layout,{params:{templateId:t.form.value,alias:t.form.name,reportType:"专业模板",folderId:t.baseData.id,templateUrl:t.form.templateUrl},Vue:t}).then(function(e){e.result&&(t.customConfig.dialogVisible=!1,t.$emit("addSuccess"),t.$message({type:"success",message:e.message}))})})},handleChange:function(t){if(!t)return this.currentTemUrl="",this.form.templateUrl="",!1;var e=this.modellist.findIndex(function(e){return e.id==t});this.form.templateUrl=this.modellist[e].templatePath,this.currentTemUrl=this.modellist[e].pic}},components:{superLayout:v.a}},w={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"major-border"},[i("board-toast",{attrs:{config:t.customConfig},on:{cancel:t.cancel,save:t.save,handleClose:function(e){t.customConfig.dialogVisible=!1}}},[i("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[i("el-form",{ref:"ruleForm",attrs:{model:t.form,"label-width":"100px",rules:t.rules}},[i("el-form-item",{attrs:{label:"看板名称",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入看板名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"专业模板",prop:"value"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"medium"},on:{change:t.handleChange},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}},t._l(t.modellist,function(t){return i("el-option",{key:t.id,attrs:{label:t.alias,value:t.id}})}))],1)],1)],1),t._v(" "),i("div",{staticClass:"show-box no-scroll"},[i("img",{attrs:{src:t.currentTemUrl}})])])],1)},staticRenderFns:[]};var $=i("C7Lr")(D,w,!1,function(t){i("ZUxs")},null,null).exports,x=i("AnyI"),k={data:function(){return{moveData:{title:"添加看板",dialogVisible:!1,width:"500px"},currData:{},baseData:[]}},methods:{show:function(t,e){this.currData=e,this.baseData=t,this.moveData.dialogVisible=!0},customClick:function(){var t=this;this.$apis.fetchPost(p.a.sideBar.search,{params:{},Vue:this}).then(function(e){e.result&&(t.moveData.dialogVisible=!1,t.$refs.customBorder.show(e.model))})},addSuccess:function(){this.moveData.dialogVisible=!1,this.$parent.filterData()},close:function(){this.moveData.dialogVisible=!0},majorClick:function(){var t=this;this.$apis.fetchPost(x.a.pageUrl,{params:{},Vue:this}).then(function(e){e.result&&(t.moveData.dialogVisible=!1,t.$refs.majorBorder.show(e.model.items))})}},components:{customBorder:_,majorBorder:$}},N={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("board-toast",{attrs:{config:t.moveData},on:{handleClose:function(e){t.moveData.dialogVisible=!1}}},[i("div",{staticClass:"border-add-btn",on:{click:t.customClick}},[t._v("自定义看板")]),t._v(" "),i("div",{staticClass:"border-add-btn",on:{click:t.majorClick}},[t._v("专业化模板报表")])]),t._v(" "),i("custom-border",{ref:"customBorder",attrs:{baseData:t.baseData},on:{close:t.close,addSuccess:t.addSuccess}}),t._v(" "),i("major-border",{ref:"majorBorder",attrs:{baseData:t.baseData},on:{close:t.close,addSuccess:t.addSuccess}})],1)},staticRenderFns:[]};var F=i("C7Lr")(k,N,!1,function(t){i("sxIm")},"data-v-5a650f70",null).exports,S=i("9rMa"),I={data:function(){return{isSearch:!1,searchData:"",openIndex:-1,activeBar:{},dragNode:{dragParentId:null,dragData:null,lastParentId:null,dragParentNode:null},sidbarData:[],emptyText:"暂无数据"}},props:{title:{type:String,default:function(){return""},require:!1},urls:{type:Object,default:function(){},require:!0},currentNode:{type:Object,default:function(){return{}},require:!0},configData:{type:Object,default:function(){},require:!0},prop:{default:function(){return{children:"layouts"}}}},computed:n()({},Object(S.b)(["getCurrConfigs","getCurrNode","getCurrchartId"])),mounted:function(){},methods:{setFileIcon:function(t){return[{"iconfont icon-wenjianjia":0==t.isOpen||!t.isOpen,"iconfont icon-wenjianjia-zhankai":1==t.isOpen}]},setOpenState:function(t,e){this.openIndex=e,t.isOpen?this.$set(t,"isOpen",!1):this.$set(t,"isOpen",!0)},setActiveBar:function(t,e){this.$set(this.activeBar,"isActive",!1),this.activeBar=t,this.$set(t,"isActive",!0),this.getDesign(t,e),this.$emit("currentChange",t)},getDesign:function(t,e){var i=this;this.$apis.fetchPost(this.urls.sideBar.search_layout,{params:{id:t.id},Vue:this}).then(function(a){a.result&&("布局库"==i.title?(i.$set(t,"config",a.model.config),a.model.config?(i.$set(i.currentNode,"config",JSON.parse(a.model.config)),i.configData.line=i.currentNode.config.line,i.configData.layout=i.currentNode.config.layout):(i.configData.line=0,i.configData.layout=[])):"自定义"==t.reportType?i.$nextTick(function(o){i.$emit("boardHandler",a,t,e)}):i.$set(t,"unzipPath",a.model.unzipPath),i.$set(i.currentNode,"alias",a.model.alias),i.$set(i.currentNode,"id",t.id),i.$set(i.currentNode,"folderId",a.model.folderId))})},operation:function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;switch(t.target.classList[1]){case"icon-xinzeng":this.add(e,i,o);break;case"icon-bianji":a?this.editFile(e,i):this.edit(e,i,o);break;case"icon-fuzhi":this.copy(i,o);break;case"icon-shanchu":a?this.remove(i.id,this.urls.sideBar.del_File):this.remove(i.id,this.urls.sideBar.del_layout)}},searchEnterFun:function(t,e){"blur"==e?this.filterData():13==(window.event?t.keyCode:t.which)&&this.filterData()},filterData:function(t){var e=this,i=this.searchData?{alias:this.searchData}:{};this.emptyText=this.searchData?"木有查到您需要的数据":"暂无数据",this.$apis.fetchPost(this.urls.sideBar.search,{params:i,Vue:this}).then(function(i){if(i.result){var a=JSON.parse(o()(e.sidbarData));if(t){var s=i.model.findIndex(function(e){return t.folderId==e.id});i.model[s].isOpen=!0;var n=i.model[s].reports.findIndex(function(e){return t.id==e.id});-1!=n&&e.setActiveBar(i.model[s].reports[n])}i.model.forEach(function(t,o){var s=a.findIndex(function(e){return e.id==t.id});-1!=s&&(i.model[o].isOpen=a[s].isOpen),"看板库"==e.title&&i.model.forEach(function(t,e){-1!=t.reports.findIndex(function(t){return 0==t.isDesisn})&&(i.model[e].isFileDesign=!0),t.reports.forEach(function(e,i){0==e.isDesisn&&(t.reports[i].isboardDesign=!0)})})}),e.sidbarData=i.model}else e.$message({type:"warning",message:i.message})})},addFile:function(){this.$refs.layoutAddFile.show(this.sidbarData,this.urls.sideBar.add_File)},add:function(t,e,i){"布局库"==this.title?this.$refs.layoutAdd.show(t,this.urls.sideBar.add_layout,i):this.$refs.boardAdd.show(t,this.urls.sideBar.add_layout,i)},editFile:function(t,e){this.$refs.layoutEidt.show(t,this.urls.sideBar.edit_File,e)},edit:function(t,e,i){this.$refs.layoutEidt.show(t,this.urls.sideBar.edit_layout,e,"编辑",i)},copy:function(t,e){var i=this,a={};"布局库"==this.title?(a={alias:t.alias,folderId:e,config:t.config},this.$confirm("您正在进行复制操作，确定继续吗？").then(function(t){i.$apis.fetchPost(i.urls.sideBar.add_layout,{params:a,Vue:i}).then(function(t){t.result?(i.filterData(),i.$message({type:"success",message:t.message})):i.$message({type:"warning",message:t.message})})}).catch(function(t){})):(a={alias:t.alias,folderId:e,layoutId:t.layoutId,reportType:"自定义",id:t.id},this.$confirm("您正在进行复制操作，确定继续吗？").then(function(t){i.$apis.fetchPost(i.urls.sideBar.copy_layout,{params:a,Vue:i}).then(function(t){t.result?(i.filterData(),i.$message({type:"success",message:t.message})):i.$message({type:"warning",message:t.message})})}).catch(function(t){}))},remove:function(t,e){var i=this;this.$confirm("删除操作不可逆，确定删除吗？").then(function(a){i.$apis.fetchPost(e,{params:{id:t},Vue:i}).then(function(t){t.result?(i.configData.layout=[],i.$message({type:"success",message:t.message}),i.filterData()):i.$message({type:"warning",message:t.message})})}).catch(function(t){})},adjust:function(t,e){var i=this,a={id:this.dragNode.dragData.id,folderId:t,alias:this.dragNode.dragData.alias,config:this.dragNode.dragData.config};this.$apis.fetchPost(this.urls.sideBar.edit_layout,{params:a,Vue:this}).then(function(t){t.result?(i.$message({type:"success",message:t.message}),i.filterData()):i.$message({type:"warning",message:t.message})})},dragstart:function(t,e,i){this.dragNode={dragData:e,dragParentId:i.id,lastParentId:i.id,dragParentNode:i}},dragenter:function(t,e,i){"sbl-item-header"!=t.target.className&&"sbl-l-item"!=t.target.className||(t.target.style["border-bottom"]="1px solid #409eff"),this.dragNode.lastParentId!=e.id&&this.$set(e,"isOpen",!0)},dragleave:function(t,e,i,a){"sbl-item-header"!=t.target.className&&"sbl-l-item"!=t.target.className||(t.target.style["border-bottom"]="1px solid #fff"),this.dragNode.lastParentId=e.id},dragend:function(t,e,i){var a=this;if("布局库"==this.title){var o=this.dragNode.dragParentNode.layouts.findIndex(function(t){return t.id==a.dragNode.dragData.id});if("sbl-item-header"==t.target.className)-1!=o&&(this.dragNode.dragParentNode.layouts.splice(o,1),this.adjust(e.id,1)),e.layouts.unshift(this.dragNode.dragData);else if("sbl-l-item"==t.target.className&&i){-1!=o&&this.dragNode.dragParentNode.layouts.splice(o,1);var s=e.layouts.findIndex(function(t){return t.id==i.id});e.layouts.splice(s+1,0,this.dragNode.dragData),this.adjust(e.id,s+2)}t.target.style["border-bottom"]="1px solid #ffffff00"}else{var n=this.dragNode.dragParentNode.reports.findIndex(function(t){return t.id==a.dragNode.dragData.id});if("sbl-item-header"==t.target.className)-1!=n&&(this.dragNode.dragParentNode.reports.splice(n,1),this.adjust(e.id,1)),e.reports.unshift(this.dragNode.dragData);else if("sbl-l-item"==t.target.className&&i){-1!=n&&this.dragNode.dragParentNode.reports.splice(n,1);var r=e.reports.findIndex(function(t){return t.id==i.id});e.reports.splice(r+1,0,this.dragNode.dragData),this.adjust(e.id,r+2)}t.target.style["border-bottom"]="1px solid #ffffff00"}}},components:{layoutEidt:f,layoutAdd:h,layoutAddFile:c,boardAdd:F}},V={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sider-bar"},[i("div",{staticClass:"sider-bar-body"},[i("div",{staticClass:"sider-bar-head"},[i("div",{staticClass:"sbh-title"},[t._v("\n        "+t._s(t.title)+"\n      ")]),t._v(" "),i("div",{staticClass:"sbh-operation"},[i("el-input",{directives:[{name:"show",rawName:"v-show",value:t.isSearch,expression:"isSearch"}],staticStyle:{width:"100px"},attrs:{placeholder:"请输入内容",size:"mini"},on:{blur:function(e){t.searchEnterFun(e,"blur")}},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.searchEnterFun(e,"keyup")}},model:{value:t.searchData,callback:function(e){t.searchData="string"==typeof e?e.trim():e},expression:"searchData"}}),t._v(" "),i("i",{staticClass:"iconfont icon-chaxun",on:{click:function(e){t.isSearch=!t.isSearch}}}),t._v(" "),i("i",{staticClass:"iconfont icon-xinzeng-",on:{click:t.addFile}}),t._v(" "),t._t("default")],2)]),t._v(" "),t.sidbarData.length?t._e():i("div",{staticClass:"sider-bar-empty"},[t._v(t._s(t.emptyText))]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.sidbarData.length,expression:"sidbarData.length"}],staticClass:"sider-bar-list"},t._l(t.sidbarData,function(e,a){return i("div",{key:e.id,staticClass:"sbl-item",on:{dragover:function(t){t.preventDefault()},drop:function(i){i.preventDefault(),t.dragend(i,e)},dragenter:function(i){i.preventDefault(),t.dragenter(i,e)},dragleave:function(i){i.preventDefault(),t.dragleave(i,e)}}},[i("div",{staticClass:"sbl-item-header"},[i("div",{staticClass:"sbl-l-item-left",on:{click:function(i){t.setOpenState(e,a)}}},[i("i",{class:t.setFileIcon(e)}),t._v(" "),i("span",[t._v(t._s(e.alias))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.openIndex==a&&e.isOpen,expression:"openIndex==index&&data.isOpen"}],staticClass:"sbl-l-item-right",on:{click:function(i){t.operation(i,e,e,"file",e.id)}}},[i("i",{staticClass:"iconfont icon-xinzeng"}),t._v(" "),e.isFileDesign?t._e():i("i",{staticClass:"iconfont icon-bianji"}),t._v(" "),e.isFileDesign?t._e():i("i",{staticClass:"iconfont icon-shanchu"})])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpen,expression:"data.isOpen"}],staticClass:"sbl-items-list"},t._l(e[t.prop.children],function(a,o){return i("div",{key:a.id,staticClass:"sbl-l-item",class:{"active-bar":t.activeBar.id===a.id},on:{drop:function(i){i.preventDefault(),t.dragend(i,e,a)},dragleave:function(i){i.preventDefault(),t.dragleave(i,e,a,o)},dragenter:function(i){i.preventDefault(),t.dragenter(i,e,a)}}},[i("div",{staticClass:"sbl-l-item-left",attrs:{draggable:"true"},on:{click:function(e){t.setActiveBar(a,t.currentNode.id)},dragstart:function(i){t.dragstart(i,a,e)}}},[i("i",{staticClass:"iconfont icon-kanbanmiaoshu"}),t._v(" "),i("span",{attrs:{title:a.alias}},[t._v(t._s(a.alias))])]),t._v(" "),a.isboardDesign?t._e():i("div",{directives:[{name:"show",rawName:"v-show",value:a.isActive,expression:"item.isActive"}],staticClass:"sbl-l-item-right",on:{click:function(i){t.operation(i,e.layouts,a,"",e.id)}}},[i("i",{staticClass:"iconfont icon-bianji"}),t._v(" "),i("i",{staticClass:"iconfont icon-fuzhi"}),t._v(" "),i("i",{staticClass:"iconfont icon-shanchu"})])])}))])}))]),t._v(" "),i("layout-add-file",{ref:"layoutAddFile",attrs:{title:t.title}}),t._v(" "),i("layout-add",{ref:"layoutAdd"}),t._v(" "),i("layout-eidt",{ref:"layoutEidt",attrs:{title:t.title}}),t._v(" "),i("board-add",{ref:"boardAdd"})],1)},staticRenderFns:[]};var z=i("C7Lr")(I,V,!1,function(t){i("Ysrz")},null,null);e.a=z.exports},Ysrz:function(t,e){},ZUxs:function(t,e){},dV6S:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("IHPB"),o=i.n(a),s=i("3cXf"),n=i.n(s),r=i("4YfN"),l=i.n(r),c=i("9rMa"),d=i("WNAK"),u=i("xXv6"),f=i("TrN9"),g={data:function(){return{dialogConfig:{title:"标题设置",dialogVisible:!1,width:"500px",btnData:["cancel","save"]},options:["FangSong","Microsoft JhengHei","SimHei","\tSimSun"],option:{fontSize:[{name:"12px",value:12},{name:"14px",value:14},{name:"16px",value:16},{name:"18px",value:18},{name:"20px",value:20},{name:"22px",value:22},{name:"24px",value:24},{name:"26px",value:26},{name:"28px",value:28},{name:"30px",value:30},{name:"35px",value:35},{name:"40px",value:40},{name:"45px",value:45},{name:"50px",value:50}]}}},props:{titleConfig:{type:Object,default:function(){return{}}},currentFile:{require:!0}},mounted:function(){},methods:{show:function(){this.dialogConfig.dialogVisible=!0},close:function(){this.dialogConfig.dialogVisible=!1},save:function(){var t=this,e=l()({},this.currentFile),i={id:e.id,config:e.config};i.config=JSON.parse(i.config),i.config.titleConfig=this.titleConfig,i.config=n()(i.config),this.$apis.fetchPost(f.a.sideBar.edit_layout,{params:i,Vue:this}).then(function(e){e.result&&(t.close(),t.$emit("titleSuccess",i))})}}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogConfig.dialogVisible?i("board-toast",{staticClass:"board-title-config",attrs:{config:t.dialogConfig},on:{cancel:t.close,save:t.save}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.titleConfig,"label-width":"100px",size:"samll"}},[i("h1",[t._v("主标题")]),t._v(" "),i("el-form-item",{attrs:{label:"标题:"}},[i("el-col",{attrs:{span:20}},[i("el-input",{attrs:{size:"mini"},model:{value:t.titleConfig.title.text,callback:function(e){t.$set(t.titleConfig.title,"text","string"==typeof e?e.trim():e)},expression:"titleConfig.title.text"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"字号:"}},[i("el-col",{attrs:{span:20}},[i("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.titleConfig.title.fontsize,callback:function(e){t.$set(t.titleConfig.title,"fontsize",e)},expression:"titleConfig.title.fontsize"}},t._l(t.option.fontSize,function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})}))],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"字体:"}},[i("el-col",{attrs:{span:20}},[i("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:t.titleConfig.title.fontFamily,callback:function(e){t.$set(t.titleConfig.title,"fontFamily",e)},expression:"titleConfig.title.fontFamily"}},t._l(t.options,function(t,e){return i("el-option",{key:e,attrs:{label:t,value:t}})}))],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"字体颜色:"}},[i("el-col",{attrs:{span:20}},[i("el-color-picker",{attrs:{size:"mini","show-alpha":""},model:{value:t.titleConfig.title.color,callback:function(e){t.$set(t.titleConfig.title,"color",e)},expression:"titleConfig.title.color"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"位置:"}},[i("el-col",{attrs:{span:20}},[i("el-radio-group",{attrs:{size:"mini"},model:{value:t.titleConfig.title.position,callback:function(e){t.$set(t.titleConfig.title,"position",e)},expression:"titleConfig.title.position"}},[i("el-radio",{attrs:{label:"left"}},[t._v("左对齐")]),t._v(" "),i("el-radio",{attrs:{label:"center"}},[t._v("居中")]),t._v(" "),i("el-radio",{attrs:{label:"right"}},[t._v("右对齐")])],1)],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"是否显示:"}},[i("el-col",{attrs:{span:20}},[i("el-checkbox",{model:{value:t.titleConfig.title.isShow,callback:function(e){t.$set(t.titleConfig.title,"isShow",e)},expression:"titleConfig.title.isShow"}},[t._v("显示")])],1)],1),t._v(" "),i("h1",[t._v("副标题")]),t._v(" "),i("el-form-item",{attrs:{label:"标题:"}},[i("el-col",{attrs:{span:20}},[i("el-input",{attrs:{size:"mini"},model:{value:t.titleConfig.subTitle.text,callback:function(e){t.$set(t.titleConfig.subTitle,"text","string"==typeof e?e.trim():e)},expression:"titleConfig.subTitle.text"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"字号:"}},[i("el-col",{attrs:{span:20}},[i("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.titleConfig.subTitle.fontsize,callback:function(e){t.$set(t.titleConfig.subTitle,"fontsize",e)},expression:"titleConfig.subTitle.fontsize"}},t._l(t.option.fontSize,function(t){return i("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})}))],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"字体:"}},[i("el-col",{attrs:{span:20}},[i("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:t.titleConfig.subTitle.fontFamily,callback:function(e){t.$set(t.titleConfig.subTitle,"fontFamily",e)},expression:"titleConfig.subTitle.fontFamily"}},t._l(t.options,function(t,e){return i("el-option",{key:e,attrs:{label:t,value:t}})}))],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"字体颜色:"}},[i("el-col",{attrs:{span:20}},[i("el-color-picker",{attrs:{size:"mini","show-alpha":""},model:{value:t.titleConfig.subTitle.color,callback:function(e){t.$set(t.titleConfig.subTitle,"color",e)},expression:"titleConfig.subTitle.color"}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"位置:"}},[i("el-col",{attrs:{span:20}},[i("el-radio-group",{attrs:{size:"mini"},model:{value:t.titleConfig.subTitle.position,callback:function(e){t.$set(t.titleConfig.subTitle,"position",e)},expression:"titleConfig.subTitle.position"}},[i("el-radio",{attrs:{label:"left"}},[t._v("左对齐")]),t._v(" "),i("el-radio",{attrs:{label:"center"}},[t._v("居中")]),t._v(" "),i("el-radio",{attrs:{label:"right"}},[t._v("右对齐")])],1)],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"是否显示:"}},[i("el-col",{attrs:{span:20}},[i("el-checkbox",{model:{value:t.titleConfig.subTitle.isShow,callback:function(e){t.$set(t.titleConfig.subTitle,"isShow",e)},expression:"titleConfig.subTitle.isShow"}},[t._v("显示")])],1)],1)],1)],1):t._e()},staticRenderFns:[]};var h=i("C7Lr")(g,m,!1,function(t){i("mw/e")},null,null).exports,p={data:function(){return{dialogConfig:{title:"背景设置",dialogVisible:!1,width:"400px",btnData:["cancel","save"]}}},props:{bgconfig:{type:Object,default:function(){return{type:"null"}}},currentFile:{type:Object}},mounted:function(){},methods:{show:function(){this.dialogConfig.dialogVisible=!0},close:function(){this.dialogConfig.dialogVisible=!1},handleAvatarSuccess:function(t,e){this.$set(this.bgconfig,"imageUrl",t.fileUrl)},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,i=t.size/1024/1024<2;return e||this.$message.error("上传背景图片只能是 JPG 格式!"),i||this.$message.error("上传背景图片大小不能超过 2MB!"),e&&i},save:function(){var t=this,e=l()({},this.currentFile),i={id:e.id,config:e.config};i.config=JSON.parse(i.config),"null"==this.bgconfig.type?i.config.bgConfig={opacticy:this.bgconfig.opacticy,type:this.bgconfig.type}:"bgColor"==this.bgconfig.type?i.config.bgConfig={opacticy:this.bgconfig.opacticy,type:this.bgconfig.type,color:this.bgconfig.color}:i.config.bgConfig={opacticy:this.bgconfig.opacticy,type:this.bgconfig.type,imageUrl:this.bgconfig.imageUrl},i.config=n()(i.config),this.$apis.fetchPost(f.a.sideBar.edit_layout,{params:i,Vue:this}).then(function(e){e.result&&(t.close(),t.$emit("saveSuccess",i))})}}},b={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogConfig.dialogVisible?i("board-toast",{staticClass:"board-config-background",attrs:{config:t.dialogConfig},on:{cancel:t.close,save:t.save}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.bgconfig,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"背景设置:"}},[i("el-radio-group",{model:{value:t.bgconfig.type,callback:function(e){t.$set(t.bgconfig,"type",e)},expression:"bgconfig.type"}},[i("el-radio",{attrs:{label:"null"}},[t._v("无")]),t._v(" "),i("el-radio",{attrs:{label:"bgColor"}},[t._v("背景色")]),t._v(" "),i("el-radio",{attrs:{label:"bgImage"}},[t._v("背景图")])],1)],1),t._v(" "),"null"!=t.bgconfig.type?i("div",[i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"bgColor"==t.bgconfig.type,expression:"bgconfig.type=='bgColor'"}],attrs:{label:"背景色:"}},[i("el-color-picker",{attrs:{"show-alpha":""},model:{value:t.bgconfig.color,callback:function(e){t.$set(t.bgconfig,"color",e)},expression:"bgconfig.color"}})],1),t._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"bgImage"==t.bgconfig.type,expression:"bgconfig.type=='bgImage'"}],attrs:{label:"背景图:"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://122.225.78.66:8899/fileSystem/uploadFile","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.bgconfig.imageUrl?i("img",{staticClass:"avatar",attrs:{src:t.bgconfig.imageUrl}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1):t._e()],1)],1):t._e()},staticRenderFns:[]};var v=i("C7Lr")(p,b,!1,function(t){i("AGoC")},null,null).exports,C={data:function(){return{dialogConfig:{title:"背景设置",dialogVisible:!1,width:"400px",btnData:["cancel","save"]}}},props:{bgconfig:{type:Object,default:function(){return{type:"null"}}},currentFile:{type:Object}},mounted:function(){},methods:{initBorder:function(){this.bgconfig.borderColor="rgba(0, 0, 0, 0.3)"},show:function(){this.dialogConfig.dialogVisible=!0},close:function(){this.dialogConfig.dialogVisible=!1},save:function(){var t=this,e=l()({},this.currentFile),i={id:e.id,config:e.config};i.config=JSON.parse(i.config),"null"==this.bgconfig.type?i.config.bgConfig={opacticy:this.bgconfig.opacticy,type:this.bgconfig.type,borderColor:this.bgconfig.borderColor,borderType:this.bgconfig.borderType}:"bgColor"==this.bgconfig.type?i.config.bgConfig={opacticy:this.bgconfig.opacticy,type:this.bgconfig.type,color:this.bgconfig.color,borderColor:this.bgconfig.borderColor,borderType:this.bgconfig.borderType}:i.config.bgConfig={opacticy:this.bgconfig.opacticy,type:this.bgconfig.type,imageUrl:this.bgconfig.imageUrl,borderColor:this.bgconfig.borderColor,borderType:this.bgconfig.borderType},i.config=n()(i.config),this.$apis.fetchPost(f.a.sideBar.edit_layout,{params:i,Vue:this}).then(function(e){e.result&&(t.close(),t.$emit("saveSuccess",i))})}}},y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogConfig.dialogVisible?i("board-toast",{staticClass:"board-config-background",attrs:{config:t.dialogConfig},on:{cancel:t.close,save:t.save}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.bgconfig,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"边框类型:"}},[i("el-radio-group",{on:{change:t.initBorder},model:{value:t.bgconfig.borderType,callback:function(e){t.$set(t.bgconfig,"borderType",e)},expression:"bgconfig.borderType"}},[i("el-radio",{attrs:{label:"default"}},[t._v("默认")]),t._v(" "),i("el-radio",{attrs:{label:"custom"}},[t._v("自定义")])],1)],1),t._v(" "),"custom"==t.bgconfig.borderType?i("el-form-item",{attrs:{label:"边框颜色:"}},[i("el-color-picker",{attrs:{"show-alpha":""},model:{value:t.bgconfig.borderColor,callback:function(e){t.$set(t.bgconfig,"borderColor",e)},expression:"bgconfig.borderColor"}})],1):t._e()],1)],1):t._e()},staticRenderFns:[]};var _=i("C7Lr")(C,y,!1,function(t){i("FYNu")},null,null).exports,D=i("9Bl9"),w={data:function(){return{form:{value:""},rules:{value:[{required:!0,message:"请选择布局方案",trigger:"change"}]},configData:{layout:[],rowHeight:50,isDraggable:!1,isResizable:!1,line:1},customConfig:{title:"布局设置",dialogVisible:!1,width:"400px",btnData:["cancel","save"],list:[]},modellist:[]}},props:["currentFile"],methods:{show:function(t){var e=this;this.form={value:this.currentFile.layoutId},this.$apis.fetchPost(D.a.sideBar.search_layout,{params:{id:this.currentFile.layoutId},Vue:this}).then(function(t){t.result&&(t.model.config?e.configData.layout=JSON.parse(t.model.config).layout:e.configData.layout=[])}),this.modellist=t,this.customConfig.dialogVisible=!0},cancel:function(){this.customConfig.dialogVisible=!1,this.$emit("close")},save:function(){var t=this;this.$refs.ruleForm.validate(function(e){if(!e)return!1;var i={id:l()({},t.currentFile).id,layoutConfig:n()(t.configData),layoutId:t.form.value};t.$apis.fetchPost(f.a.sideBar.edit_layout,{params:i,Vue:t}).then(function(e){e.result&&(t.customConfig.dialogVisible=!1,t.$emit("layoutSuccess",i.layoutConfig))})})},handleChange:function(t){var e=this;t&&this.$apis.fetchPost(D.a.sideBar.search_layout,{params:{id:t},Vue:this}).then(function(t){t.result&&(t.model.config?e.configData.layout=JSON.parse(t.model.config).layout:e.configData.layout=[])})}},components:{superLayout:u.a}},$={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"custom-border"},[i("board-toast",{attrs:{config:t.customConfig},on:{cancel:t.cancel,save:t.save,handleClose:function(e){t.customConfig.dialogVisible=!1}}},[i("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[i("el-form",{ref:"ruleForm",attrs:{model:t.form,"label-width":"100px",rules:t.rules}},[i("el-form-item",{attrs:{label:"布局方案",prop:"value"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"medium"},on:{change:t.handleChange},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}},t._l(t.modellist,function(e){return i("el-option-group",{key:e.id,attrs:{label:e.alias}},t._l(e.layouts,function(t){return i("el-option",{key:t.id,attrs:{label:t.alias,value:t.id}})}))}))],1)],1)],1),t._v(" "),i("div",{staticClass:"show-box no-scroll"},[i("super-layout",{ref:"superLayout",attrs:{config:t.configData,isToolbar:!1,tool:[]}})],1)])],1)},staticRenderFns:[]};var x=i("C7Lr")(w,$,!1,function(t){i("oSkE")},null,null).exports,k={data:function(){return{dialogConfig:{title:"图表联动设置",dialogVisible:!1,width:"800px",btnData:["close"]},boardChart:[],option:[],fromObj:null,type:"add",tableData:[],formData:{toId:"",linkParam:""},rules:{toId:[{required:!0,message:"请选择被联动目标",trigger:"change"}],linkParam:[{required:!0,message:"请选择联动参数",trigger:"change"}]}}},props:{currentNode:{type:Object,default:function(){return null}}},mounted:function(){},watch:{"dialogConfig.dialogVisible":{handler:function(){this.dialogConfig.dialogVisible||this.$parent.reGetBoard(this.currentNode,this.currentNode.id)}}},methods:{show:function(t,e){this.formData.fromId=t.from.id,this.formData.fromName=t.from.name,this.option=t.from.props,this.boardChart=t.toOption,this.dialogConfig.dialogVisible=!0,this.tableData=e.filter(function(e){return e.fromId==t.from.id}),this.empty()},close:function(){this.dialogConfig.dialogVisible=!1},setOption:function(){var t=this;return this.boardChart.filter(function(e){return-1==t.tableData.findIndex(function(t){return e.id==t.toId})})},setParamOption:function(t){var e=this.boardChart.findIndex(function(e){return e.id==t});this.option=-1!=e?this.boardChart[e].props:[]},check:function(t){this.$refs.formData.validate(function(e){if(!e)return!1;t()})},del:function(t){var e=this;this.$apis.fetchPost(f.a.sideBar.del_Link,{params:{id:t.id},Vue:this}).then(function(i){if(i.result){var a=e.tableData.findIndex(function(e){return e.id==t.id});e.tableData.splice(a,1),e.$message({type:"success",message:i.message})}else e.$message({type:"warning",message:i.message})})},add:function(){var t=this,e=this.boardChart.findIndex(function(e){return e.id==t.formData.toId}),i={fromId:this.formData.fromId,fromName:this.formData.fromName,toId:this.formData.toId,toName:this.boardChart[e].toName,boardId:this.currentNode.id,linkParam:this.formData.linkParam};this.$apis.fetchPost(f.a.sideBar.add_Link,{params:i,Vue:this}).then(function(e){e.result?(t.tableData.push(e.model),t.empty(),t.$message({type:"success",message:e.message})):t.$message({type:"warning",message:e.message})})},empty:function(){this.formData.toId="",this.formData.linkParam="",this.$forceUpdate(),this.option=[],this.$refs.formData&&this.$refs.formData.resetFields()},rowClick:function(t){this.type="edit",this.formData={fromId:t.fromId,fromName:t.fromName,toId:t.toId,toName:t.toName,linkParam:t.linkParam,id:t.id}},save:function(){var t=this,e=this.boardChart.findIndex(function(e){return e.id==t.formData.toId}),i={fromId:this.formData.fromId,fromName:this.formData.fromName,toId:this.formData.toId,toName:this.boardChart[e].toName,boardId:this.currentNode.id,id:this.formData.id,linkParam:this.formData.linkParam};this.$apis.fetchPost(f.a.sideBar.up_Link,{params:i,Vue:this}).then(function(e){if(e.result){var a=t.tableData.findIndex(function(t){return t.id==i.id});t.tableData.splice(a,1,JSON.parse(n()(t.formData))),t.empty(),t.type="add",t.$message({type:"success",message:e.message})}else t.$message({type:"warning",message:e.message})})}}},N={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogConfig.dialogVisible?i("board-toast",{attrs:{config:t.dialogConfig},on:{close:t.close}},[i("div",{staticClass:"board-param-top"},[i("el-form",{ref:"formData",attrs:{model:t.formData,rules:t.rules,"label-width":"100px"}},[i("el-row",[i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"联动目标:"}},[t._v("\n            "+t._s(t.formData.fromName)+"\n          ")])],1),t._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"被联动目标:",prop:"toId"}},[i("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:function(e){t.setParamOption(t.formData.toId)}},model:{value:t.formData.toId,callback:function(e){t.$set(t.formData,"toId",e)},expression:"formData.toId"}},t._l(t.setOption(),function(t){return i("el-option",{key:t.id,attrs:{label:t.toName,value:t.id}})}))],1)],1),t._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"联动参数:",prop:"linkParam"}},[i("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:t.formData.linkParam,callback:function(e){t.$set(t.formData,"linkParam",e)},expression:"formData.linkParam"}},t._l(t.option,function(t){return i("el-option",{key:t.prop,attrs:{label:t.label,value:t.prop}})}))],1)],1)],1)],1)],1),t._v(" "),i("div",{staticStyle:{position:"relative",height:"40px"}},[i("div",{staticStyle:{position:"absolute",top:"0",right:"0"}},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:"add"==t.type,expression:"type=='add'"}],attrs:{type:"primary",size:"mini"},on:{click:function(e){e.stopPropagation(),t.check(t.add)}}},[t._v("新增")]),t._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:"add"==t.type,expression:"type=='add'"}],attrs:{size:"mini"},on:{click:function(e){e.stopPropagation(),t.empty()}}},[t._v("清空")]),t._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:"edit"==t.type,expression:"type=='edit'"}],attrs:{size:"mini"},on:{click:function(e){e.stopPropagation(),t.check(t.save)}}},[t._v("保存")])],1)]),t._v(" "),i("div",{staticClass:"board-param-main"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:"","max-height":"500"},on:{"row-dblclick":t.rowClick}},[i("el-table-column",{attrs:{prop:"fromName",label:"联动目标",width:"180","header-align":"center",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"toName",label:"被联动目标",width:"180","header-align":"center",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"linkParam",label:"联动参数","header-align":"center",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"100","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){t.del(e.row)}}},[t._v("删除")])]}}])})],1)],1)]):t._e()},staticRenderFns:[]};var F=i("C7Lr")(k,N,!1,function(t){i("7UBM")},null,null).exports,S=i("4/pB"),I={data:function(){return{}},props:["zoomObj"],components:{chartsView:S.a}},V={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"board-zoom-mask"},[i("el-dialog",{attrs:{visible:t.zoomObj.isShow,"show-close":!1,fullscreen:!0,width:"30%"},on:{"update:visible":function(e){t.$set(t.zoomObj,"isShow",e)}}},[i("i",{staticClass:"iconfont icon-enlarge-02",staticStyle:{position:"absolute",right:"24px","z-index":"100",top:"16px"},on:{click:function(e){t.zoomObj.isShow=!1}}}),t._v(" "),t.zoomObj.config?i("charts-view",{ref:"myZoomChart",attrs:{id:t.zoomObj.i+"zoom",config:t.zoomObj.config}}):t._e()],1)],1)},staticRenderFns:[]};var z=i("C7Lr")(I,V,!1,function(t){i("MZh4")},null,null).exports,O={data:function(){return{dialogConfig:{title:"看板授权维护",dialogVisible:!1,width:"800px",btnData:["close"]},userId:"",options:[],tableData:[],selectRows:[]}},props:["board","currentNode"],watch:{"dialogConfig.dialogVisible":{handler:function(){this.dialogConfig.dialogVisible||this.$parent.reGetBoard(this.board,this.board.id)}}},mounted:function(){this.getOption()},methods:{show:function(){this.dialogConfig.dialogVisible=!0,this.getList()},getList:function(){var t=this;this.$apis.fetchPost(f.a.sideBar.get_grant,{params:{folderId:this.board.id},Vue:this}).then(function(e){e.result?(e.model.forEach(function(t,i){e.model[i].isView=!!t.isView,e.model[i].isDesisn=!!t.isDesisn}),t.tableData=e.model):t.$message({type:"warning",message:e.message})})},close:function(){this.dialogConfig.dialogVisible=!1},add:function(t){var e=this;if(t){var i={folderId:this.board.id,userId:t,isView:0,isDesisn:0};this.$apis.fetchPost(f.a.sideBar.add_grant,{params:i,Vue:this}).then(function(t){t.result?(e.getList(),e.userId=""):e.$message({type:"warning",message:t.message})})}else this.$message({type:"warning",message:"请选择待添加人员"})},handleClick:function(t){var e=this,i={folderId:t.folderId,userId:t.userId,isView:t.isView?1:0,isDesisn:t.isDesisn?1:0,id:t.id};this.$apis.fetchPost(f.a.sideBar.upd_grant,{params:i,Vue:this}).then(function(t){t.result?(e.$message({type:"success",message:"保存成功"}),e.getList()):e.$message({type:"warning",message:t.message})})},handleSelectionChange:function(t){this.selectRows=t},remove:function(){var t=this,e=this.selectRows.map(function(t){return t.id}).join(",");this.$apis.fetchPost(f.a.sideBar.del_grant,{params:{ids:e},Vue:this}).then(function(e){e.result?(t.getList(),t.$message({type:"success",message:e.message})):t.$message({type:"warning",message:e.message})})},getOption:function(){var t=this;this.$apis.fetchPost(f.a.sideBar.getEmp_grant,{params:null,Vue:this}).then(function(e){if(e.result){if(e.model.length){var i=e.model.map(function(t){return{label:t.orgName+"   "+t.empName,value:t.userId}});t.options=i}}else t.$message({type:"warning",message:e.message})})}}},P={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogConfig.dialogVisible?i("board-toast",{attrs:{config:t.dialogConfig},on:{close:t.close}},[i("div",{staticClass:"board-authorization-top"},[i("div",[i("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择待添加人员",size:"mini"},model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}},t._l(t.options,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),i("div",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){e.stopPropagation(),t.add(t.userId)}}},[t._v("添加人员")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:function(e){return e.stopPropagation(),t.remove(e)}}},[t._v("移除人员")])],1)]),t._v(" "),i("div",{staticClass:"board-authorization-main"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:"",align:"center","max-height":"500","header-align":"center"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),i("el-table-column",{attrs:{prop:"orgName",label:"部门名称",width:"180"}}),t._v(" "),i("el-table-column",{attrs:{prop:"empName",label:"人员",width:"180"}}),t._v(" "),i("el-table-column",{attrs:{label:"看板权限"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-checkbox",{model:{value:e.row.isView,callback:function(i){t.$set(e.row,"isView",i)},expression:"scope.row.isView"}},[t._v("浏览")]),t._v(" "),i("el-checkbox",{model:{value:e.row.isDesisn,callback:function(i){t.$set(e.row,"isDesisn",i)},expression:"scope.row.isDesisn"}},[t._v("设计")])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){t.handleClick(e.row)}}},[t._v("保存授权")])]}}])})],1)],1)]):t._e()},staticRenderFns:[]};var T=i("C7Lr")(O,P,!1,function(t){i("x8cd")},null,null).exports,B={data:function(){return{currentFile:{id:-1},defaultProp:{children:"reports"},isToolbar:!1,isAdmin:!0,configData:{layout:[],rowHeight:200,isDraggable:!0,isResizable:!0,line:1,bgConfig:{type:"null",imageUrl:"",opacticy:1,borderType:"default"},titleConfig:{title:{},subTitle:{}}},bgconfig:{},titleConfig:{title:{},subTitle:{}},currentNode:{config:[],id:void 0,folderId:void 0,alias:void 0},url:null,zoomObj:{config:null,id:"",isShow:!1},linkages:null}},created:function(){this.url=f.a},computed:l()({},Object(c.b)(["getCurrConfigs","getCurrNode","getCurrchartId"])),mounted:function(){this.$refs.sidebar.filterData(this.getCurrNode)},methods:l()({},Object(c.c)(["setCurrConfigs","setCurrNode","setCurrchartId","setCurrentBackground"]),{reGetBoard:function(t,e){this.$refs.sidebar.getDesign(l()({},t,{reportType:"自定义"}),e)},setBg:function(){return"null"==this.configData.bgConfig.type?"#fff":"bgColor"==this.configData.bgConfig.type?this.configData.bgConfig.color:"url("+this.configData.bgConfig.imageUrl+") no-repeat"},setStyle:function(t){var e="";return this.configData.titleConfig[t].fontsize?e=e+"font-size:"+this.configData.titleConfig[t].fontsize+"px;":e+="font-size:12px",this.configData.titleConfig[t].fontFamily?e=e+"font-family:"+this.configData.titleConfig[t].fontFamily+";":e+="fontFamily:SimHei;",this.configData.titleConfig[t].color?e=e+"color:"+this.configData.titleConfig[t].color+";":e+="color:#000;","left"==this.configData.titleConfig[t].position||"right"==this.configData.titleConfig[t].position?e=this.configData.titleConfig.title.position===this.configData.titleConfig.subTitle.position?e+"text-align:"+this.configData.titleConfig.subTitle.position+";":e+"float:"+this.configData.titleConfig[t].position+";":e+="text-align:center;",this.configData.titleConfig[t].isShow?e+="display:block;":e+="display:none;",e},handleCommand:function(t){var e=this;switch(t){case"背景设置":this.bgconfig=l()({},this.configData.bgConfig),this.$refs.bgSet.show();break;case"边框设置":this.bgconfig=l()({},this.configData.bgConfig),this.$refs.borderSet.show();break;case"布局设置":this.$apis.fetchPost(D.a.sideBar.search,{params:{},Vue:this}).then(function(t){t.result&&e.$refs.layoutSet.show(t.model)});break;case"标题设置":this.titleConfig=JSON.parse(n()(this.configData.titleConfig)),this.$refs.titleSet.show();break;case"看板授权":this.handleAuthorization()}},currentChange:function(t){this.currentFile=t},saveSuccess:function(t){this.currentFile.config=t.config,this.configData.bgConfig=JSON.parse(t.config).bgConfig},layoutSuccess:function(t){this.currentFile.layoutConfig=t,this.configData.layout=JSON.parse(t).layout},titleSuccess:function(t){this.currentFile.config=t.config,this.configData.titleConfig=JSON.parse(t.config).titleConfig},handleEdit:function(t,e){this.setCurrConfigs(t),"bgColor"==this.configData.bgConfig.type&&this.configData.bgConfig.color?this.setCurrentBackground(this.configData.bgConfig.color):this.setCurrentBackground(null),this.setCurrNode(JSON.parse(n()(this.currentNode))),this.setCurrchartId(t.i),this.$router.push("/chartCenter")},handleRefresh:function(t,e){if(!t.config)return this.$message({type:"warning",message:"请先配置图表"});t.config.data=null,this.$refs["myChart"+t.i].getData(!0)},handleDetails:function(t,e){t.boolen=!0},handleZoom:function(t,e){if(!t.config)return this.$message({type:"warning",message:"请先配置图表"});this.zoomObj.config=t.config,this.zoomObj.i=t.i,this.zoomObj.isShow=!0},handleLiandong:function(t,e,i){var a=this;if(!t.config)return this.$message({type:"warning",message:"请先配置图表"});if(t.config&&"chart"!=t.config.type)this.$message({type:"info",message:"当前图表不支持联动"});else{var s=i.layout.map(function(t,e){if(t.config)return{id:t.i,toName:e+1+"号图表--"+a.ChartName(t.config.chart),type:t.config.type,chart:t.config.chart,props:[].concat(o()(t.config.dataConfig.numberValue),o()(t.config.dataConfig.dimension))}}).filter(function(e){if(e)return"chart"==e.type&&e.id!==t.i}),n={from:{id:t.i,type:t.config.chart,props:[].concat(o()(t.config.dataConfig.numberValue),o()(t.config.dataConfig.dimension)),index:e,name:e+1+"号图表--"+this.ChartName(t.config.chart)},toOption:s};this.$refs.linkChart.show(n,this.linkages)}},handleAuthorization:function(t){this.$refs.authorization.show()},boardHandler:function(t,e,i){var a=this;this.$set(e,"layoutConfig",t.model.layoutConfig),this.$set(e,"layoutId",t.model.layoutId),this.linkages=t.model.linkages,t.model.desisn?this.isToolbar=!1:this.isToolbar=!0,t.model.giveDes?this.isAdmin=!0:this.isAdmin=!1,this.$set(e,"datasourceLocationValueDtos",t.model.datasourceLocationValueDtos),this.configData.flag&&this.saveLayout(i,JSON.parse(n()(this.configData))),this.configData.layout=JSON.parse(t.model.layoutConfig).layout,this.configData.flag=!1,t.model.datasourceLocationValueDtos.forEach(function(t){var e=a.configData.layout.findIndex(function(e){return e.i===t.reportId});-1!=e&&t.picConfig&&(a.configData.layout[e].config=JSON.parse(t.picConfig.replace(/\$/g,"%")))}),this.configData.layout.forEach(function(t){}),t.model.config?(this.$set(e,"config",t.model.config),JSON.parse(t.model.config).bgConfig?this.configData.bgConfig=JSON.parse(t.model.config).bgConfig:this.configData.bgConfig={type:"null",opacticy:1},JSON.parse(t.model.config).titleConfig?this.configData.titleConfig=JSON.parse(t.model.config).titleConfig:this.configData.titleConfig={title:{},subTitle:{}}):(this.$set(e,"config",n()({bgConfig:{type:"null",opacticy:1},titleConfig:{title:{},subTitle:{}}})),this.configData.bgConfig={type:"null",opacticy:1},this.configData.titleConfig={title:{},subTitle:{}})},saveLayout:function(t,e){var i=this;this.$confirm("您看板布局进行了修改,需要保存吗?").then(function(a){var o=e;o.layout.forEach(function(t){t.config&&delete t.config}),delete o.titleConfig,delete o.subTitleConfig;var s={reportId:t,layoutConfig:n()(o)};i.$apis.fetchPost(f.a.sideBar.upd_layout,{params:s,Vue:i}).then(function(t){t.result||i.$message({type:"warning",message:t.message})})}).catch(function(t){})},ChartName:function(t){return{pie:"饼图",gauge:"仪表盘",funnel:"漏斗图",radar:"雷达图",bar:"柱状图",line:"折线图",scatter:"散点图",wordcloud:"字符云"}[t]}}),components:{siderBar:d.a,superLayout:u.a,boardConfigTitle:h,boardConfigBackground:v,boardConfigBorder:_,boardConfigLayout:x,boardConfigParam:F,chartsView:S.a,boardZoomChart:z,boardConfigAuthorization:T}},j={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"board-center"},[i("sider-bar",{ref:"sidebar",attrs:{title:"看板库",urls:t.url,prop:t.defaultProp,currentNode:t.currentNode,configData:t.configData,keyCode:"layoutConfig"},on:{currentChange:t.currentChange,boardHandler:t.boardHandler}},[i("i",{staticClass:"iconfont icon-gengduo",attrs:{index:3}})]),t._v(" "),i("div",{staticClass:"board-display"},[i("div",{staticClass:"board-display-body"},["自定义"==t.currentFile.reportType?i("div",{staticStyle:{height:"100%",position:"relative"}},[i("div",{staticClass:"main-body",style:{background:t.setBg(),height:"100%","background-size":"cover",opacity:t.configData.bgConfig.opacticy?t.configData.bgConfig.opacticy:1}},[i("el-dropdown",{attrs:{placement:"bottom-end"},on:{command:t.handleCommand}},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.isToolbar,expression:"!isToolbar"}],staticClass:"el-dropdown-link"},[i("i",{staticClass:"iconfont icon-shezhi"})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"标题设置"}},[t._v("标题设置")]),t._v(" "),i("el-dropdown-item",{attrs:{command:"布局设置"}},[t._v("布局设置")]),t._v(" "),i("el-dropdown-item",{attrs:{command:"背景设置"}},[t._v("背景设置")]),t._v(" "),i("el-dropdown-item",{attrs:{command:"边框设置"}},[t._v("边框设置")]),t._v(" "),i("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:t.isAdmin,expression:"isAdmin"}],attrs:{command:"看板授权"}},[t._v("看板授权")])],1)],1),t._v(" "),i("div",{staticClass:"mai-header clearfix",staticStyle:{"padding-top":"10px","min-height":"80px"}},[i("div",{staticClass:"main-title",style:t.setStyle("title")},[t._v(t._s(t.configData.titleConfig.title.text?t.configData.titleConfig.title.text:""))]),t._v(" "),i("div",{staticClass:"sub-title",style:t.setStyle("subTitle")},[t._v(t._s(t.configData.titleConfig.subTitle.text?t.configData.titleConfig.subTitle.text:""))])]),t._v(" "),i("super-layout",{ref:"superLayout",attrs:{config:t.configData,isToolbar:t.isToolbar},on:{handleedit:t.handleEdit,handlerefresh:t.handleRefresh,handlezoom:t.handleZoom,handledetails:t.handleDetails,handleliandong:t.handleLiandong},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.data;return[a.config?i("charts-view",{ref:"myChart"+a.i,attrs:{id:a.i,linkages:t.linkages,config:a.config}}):t._e()]}}])})],1)]):t._e(),t._v(" "),"专业模板"==t.currentFile.reportType?i("div",{staticStyle:{height:"100%"}},[i("iframe",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.currentFile.unzipPath,frameborder:"0"}})]):t._e()])]),t._v(" "),i("board-config-background",{ref:"bgSet",attrs:{currentFile:t.currentFile,bgconfig:t.bgconfig},on:{saveSuccess:t.saveSuccess}}),t._v(" "),i("board-config-border",{ref:"borderSet",attrs:{currentFile:t.currentFile,bgconfig:t.bgconfig},on:{saveSuccess:t.saveSuccess}}),t._v(" "),i("board-config-title",{ref:"titleSet",attrs:{titleConfig:t.titleConfig,currentFile:t.currentFile},on:{titleSuccess:t.titleSuccess}}),t._v(" "),i("board-config-param",{ref:"linkChart",attrs:{currentNode:t.currentNode}}),t._v(" "),i("board-config-layout",{ref:"layoutSet",attrs:{currentFile:t.currentFile},on:{layoutSuccess:t.layoutSuccess}}),t._v(" "),t.zoomObj.isShow?i("board-zoom-chart",{attrs:{zoomObj:t.zoomObj}}):t._e(),t._v(" "),i("board-config-authorization",{ref:"authorization",attrs:{board:t.currentNode}})],1)},staticRenderFns:[]};var E=i("C7Lr")(B,j,!1,function(t){i("TO4g")},null,null);e.default=E.exports},"mw/e":function(t,e){},oSkE:function(t,e){},sxIm:function(t,e){},x8cd:function(t,e){}});